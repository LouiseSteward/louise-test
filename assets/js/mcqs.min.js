var ebMCQsInit=function(){return-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&!!Array.prototype.forEach&&"addEventListener"in window&&document.querySelectorAll(".question")&&!document.querySelector(".table-of-questions")},ebMCQsFindNumberOfCorrectAnswers=function(e){return e.match(/\D/).index},ebMCQsPositionOfCorrectAnswer=function(e){return e.match(/[aeiou]*/)[0].length},ebMCQsDobfuscateQuestionCode=function(e){for(var t=ebMCQsFindNumberOfCorrectAnswers(e),n=e.length,r=e.substr(t,n),o=[],c=0;c<t;c++){var s=ebMCQsPositionOfCorrectAnswer(r);o.push(s),r=r.substr(2*s,r.length)}return o},ebMCQsGetCorrectAnswers=function(e){var t=e.getAttribute("data-question-code"),t=ebMCQsDobfuscateQuestionCode(t),n={};return e.querySelectorAll(".mcq-feedback li").forEach(function(e,t){n[t+1]=!1}),t.forEach(function(e){n[e]=!0}),n},ebMCQsMakeOptionCheckboxes=function(e){var o=e.getAttribute("data-question");e.querySelectorAll(".mcq-options li").forEach(function(e,t){var n=String.fromCharCode(t+65),r=o+"-option-"+n,n=document.createElement("input");n.setAttribute("type","checkbox"),n.setAttribute("data-index",t),n.setAttribute("id",r),n.setAttribute("name",o);t=document.createElement("label");t.setAttribute("for",r),t.appendChild(n),t.innerHTML=t.innerHTML+e.innerHTML,e.innerHTML="",e.appendChild(t),e.setAttribute("data-bookmarkable","no")})},ebMCQsAddButton=function(e){var t=document.createElement("button");t.innerHTML=locales[pageLanguage].questions["check-answers-button"],t.classList.add("check-answer-button");var n=e.querySelector(".mcq-feedback");e.insertBefore(t,n)},ebMCQsMakeQuestionAccessible=function(e){var t=e.querySelector("h3"),n=t.innerHTML,e=document.createElement("legend");e.innerHTML=n,t.innerHTML="",t.appendChild(e)},ebMCQsGetAllSelected=function(e){var n={};return e.querySelectorAll('[type="checkbox"]').forEach(function(e,t){n[t+1]=!1}),e.querySelectorAll('[type="checkbox"]:checked').forEach(function(e){e=parseFloat(e.getAttribute("data-index"));n[e+1]=!0}),n},ebMCQsHideAllFeedback=function(e){e.querySelectorAll(".mcq-feedback li").forEach(function(e){e.classList.remove("mcq-feedback-show")})},ebMCQsShowSelectedOptions=function(e,n){e.querySelectorAll(".mcq-feedback li").forEach(function(e,t){n[t+1]&&e.classList.add("mcq-feedback-show"),e.setAttribute("data-bookmarkable","no")})},ebMCQsShowSelectedIncorrectOptions=function(e,n,r){e.querySelectorAll(".mcq-feedback li").forEach(function(e,t){n[t+1]&&n[t+1]!==r[t+1]&&e.classList.add("mcq-feedback-show"),e.setAttribute("data-bookmarkable","no")})},ebMCQsMarkSelectedOptions=function(){document.querySelectorAll(".mcq-options li").forEach(function(e){e.addEventListener("click",function(){this.querySelector('[type="checkbox"]:checked')?this.classList.add("selected"):this.classList.remove("selected")})})},ebMCQsGetAllCorrectAnswers=function(){var n={};return document.querySelectorAll(".question").forEach(function(e){var t=ebMCQsGetCorrectAnswers(e),e=e.getAttribute("data-question");n[e]=t}),n},ebMCQsExactlyRight=function(e,t){for(var n in t)if(t[n]!==e[n])return!1;return!0},ebMCQsNotAllTheCorrectAnswers=function(e,t){var n,r=0,o=0,c=0;for(n in e)e[n]&&r++,e[n]&&t[n]&&o++,!e[n]&&t[n]&&c++;return o<r&&0===c},ebMCQsWordPressUserId=function(){var t="coreproject_sess",e=document.cookie.split("; ").find(function(e){return 0===e.indexOf(t)});return!!e&&decodeURIComponent(e).replace(t+"=","")},ebMCQsAddWordPressAccountButton=function(){var e,t,n=document.querySelector("#nav");n&&(e=n.querySelector("h2"),(t=document.createElement("a")).innerText="Log in",t.href="/login/",t.classList.add("wordpress-link"),n.insertBefore(t,e),ebMCQsWordPressUserId()&&(t.innerText="My account",t.href="/account/"))},ebMCQsSendtoWordPress=function(e,t){var n=ebMCQsWordPressUserId();if(ebMCQsWordPressUserId()){var r,o={action:"quiz_score",book_id:1,quiz_id:e,user_id:n,score:t},c=[];for(r in o)c.push(encodeURIComponent(r)+"="+encodeURIComponent(o[r]));n=c.join("&"),t=new XMLHttpRequest;t.open("POST","/wp-admin/admin-ajax.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send(n)}},ebMCQsButtonClicks=function(){document.querySelectorAll(".check-answer-button").forEach(function(e){e.addEventListener("click",function(){var e=this.parentNode,t=e.getAttribute("data-question");e.getAttribute("data-question-code");ebMCQsHideAllFeedback(e);var n=ebMCQsGetAllSelected(e),r=ebMCQsGetAllCorrectAnswers()[t];e.classList.remove("mcq-incorrect"),e.classList.remove("mcq-partially-correct"),e.classList.remove("mcq-correct");var o=0;ebMCQsExactlyRight(r,n)?(e.classList.add("mcq-correct"),ebMCQsShowSelectedOptions(e,n),o=1):(ebMCQsNotAllTheCorrectAnswers(r,n)?e.classList.add("mcq-partially-correct"):e.classList.add("mcq-incorrect"),ebMCQsShowSelectedIncorrectOptions(e,n,r));t=t.replace("question-","");ebMCQsSendtoWordPress(t,o)})})},ebMCQs=function(){ebMCQsInit()&&(ebMCQsAddWordPressAccountButton(),document.documentElement.classList.add("js-mcq"),document.querySelectorAll(".question").forEach(function(e){ebMCQsMakeOptionCheckboxes(e),ebMCQsAddButton(e),ebMCQsMakeQuestionAccessible(e)}),ebMCQsMarkSelectedOptions(),ebMCQsButtonClicks())};ebMCQs();